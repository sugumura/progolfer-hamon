/* */ 
module.exports = function(grunt) {
  var os = require('os');
  grunt.registerMultiTask('listips', 'Prints a list of active ips.', function() {
    var opts = this.options({"port": 80});
    var port = opts.port;
    var label = opts.label ? '(' + opts.label + ') ' : '';
    if (port == 80) {
      port = '';
    } else {
      port = ':' + port;
    }
    var interfaces = os.networkInterfaces();
    var addresses = [];
    for (var n in interfaces) {
      for (var n2 in interfaces[n]) {
        var address = interfaces[n][n2];
        if (address.family == 'IPv4' && !address.internal) {
          addresses.push('http://' + address.address + port);
        }
      }
    }
    addresses.push('http://localhost' + port);
    grunt.log.subhead('\n' + label + 'Listening on:\n\t', addresses.join('\n\t '));
  });
};
